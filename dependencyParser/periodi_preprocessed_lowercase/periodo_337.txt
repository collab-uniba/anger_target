most of it is rather trivial  with one ugly exception     